import time
from concurrent.futures import ThreadPoolExecutor

from util.regularApi import group_by_remark
from util.yundaApi import get_heaviest_weight_v2
from util.yundaModel import RemarkBoy


def call_recall_api(orderNo):
    res = get_heaviest_weight_v2(orderNo)
    if res is None:
        return RemarkBoy.builder() \
            .orderNo("单号：" + orderNo) \
            .remark("无小件称重记录，无法给出快件重量") \
            .build()
    return RemarkBoy.builder() \
        .orderNo("单号：" + orderNo) \
        .remark("重量：" + str(res) + "KG") \
        .build()


def batch_call_recall_api(orderNos):
    remark_boy_list = []
    start_time = time.time()  # 记录开始时间
    with ThreadPoolExecutor(max_workers=10) as executor:
        futures = [executor.submit(call_recall_api, number) for number in orderNos]
        for future in futures:
            result = future.result()
            remark_boy_list.append(result)
    end_time = time.time()  # 记录结束时间
    elapsed_time = end_time - start_time  # 计算耗时
    print(str(len(orderNos)) + "个单号多线程调用耗时：", elapsed_time, "秒")
    start_time = time.time()  # 记录开始时间
    res = group_by_remark(remark_boy_list)
    end_time = time.time()  # 记录结束时间
    elapsed_time = end_time - start_time  # 计算耗时
    print("结果分组耗时：", elapsed_time, "秒")
    return res


if __name__ == "__main__":
    numbers = [428108621935528,
               318783052115280,
               318784466438101,
               318758749508043,
               428110774059802,
               318772698538792,
               463214022453761,
               433604469901292,
               433544403616654,
               433632910478158,
               433608453509203,
               463264216749400,
               463256384244477,
               428110214804223,
               433601312122557,
               433598834659133,
               428110683769356,
               433580215179361,
               433585055436913,
               433604673071093,
               319122666663821,
               433584239325440,
               433627156941700,
               433583126138554,
               318785415634904,
               433568259057599,
               318753916902553,
               433628099475487,
               463252019292936,
               433596977812717,
               433601954164635,
               463290794281863,
               463257634770068,
               433591177250711,
               318778039667223,
               433605193581867,
               463285939422966,
               428108195904213,
               463290794991437,
               433608194072490,
               433574353586812,
               433614957599228,
               433613697321925,
               433612382401045,
               433612582783526,
               433500927938034,
               433590470928083,
               433628323557339,
               433467218958720,
               428110342878240,
               433619776365979,
               318789814832723,
               433581692266042,
               433612460683815,
               433621357454558,
               312254899409175,
               318791779912951,
               433549842723806,
               433619933491145,
               433629617340885,
               463234607955496,
               463274808246993,
               433609880435898,
               463293204232367,
               318770441706555,
               463275008148163,
               433617868064136,
               463293205205807,
               433609665670059,
               433543674633447,
               319125600862201,
               318775554214216,
               463194030215482,
               433619651659795,
               318775333142330,
               433617137900546,
               433467288435056,
               433589723993347,
               433620484533007,
               433605195986989,
               433628921162912,
               318721676926230,
               428109202912731,
               463214031495137,
               433590011821408,
               433533694101412,
               433553808314331,
               318761317054749,
               433562865040372,
               463220868207486,
               433569411888545,
               463224923210656,
               433591889776600,
               319112894033589,
               433550544596538,
               433548958116252,
               463220667743301,
               463262698377255,
               463221013868971,
               318772858371709,
               318768133337514,
               428107463906949,
               318764066754794,
               463286287118915,
               318764380856809,
               433622587417064,
               319123270029615,
               463218890869818,
               433621602563841,
               318773976157303,
               433584161067553,
               433613181526630,
               463216063838537,
               463284091417954,
               428107418323623,
               318765918980439,
               433549271660325,
               312250941283779,
               318760070778662,
               433625556071795,
               428102086487989,
               433549269350422,
               428106305523300,
               318777610252744,
               433603668115928,
               433589740060667,
               463244481638128,
               433550550082560,
               428109878959973,
               433587699391234,
               433593384109526,
               433603700706174,
               463221273977914,
               433584486438800,
               318787653879577,
               463220792369196,
               433609878739499,
               463220337524304,
               433557929339002,
               318790711881985,
               318761316525428,
               433593018736639,
               318763968643391,
               433549579753987,
               433615204876936,
               433614741371189,
               433551429970632,
               463243420648129,
               433625004019793,
               433609828768105,
               433618892896315,
               433624911806037,
               463259298932351,
               312246543841334,
               463219519708548,
               463256825753872,
               433549155042267,
               463219280036476,
               463220937010233,
               433628657831613,
               433549067990950,
               318742093486433,
               433564515306177,
               433636327232909,
               433548946202480,
               463285389499561,
               433585344659135,
               318776934514701,
               428109517621412,
               433593477695325,
               428110472302808,
               433556453433732,
               318785291893333,
               433591664474972,
               433556651520389,
               433633456782712,
               463272520717545,
               433555579817420,
               433626953167151,
               463256699712218,
               433586357217910,
               433620117880139,
               433589629165691,
               463223868533827,
               463256123066761,
               463243472156572,
               463221998273907,
               433602511088207,
               463216004073973,
               463254343391053,
               433627698939019,
               463256122949786,
               463272372787585,
               463224647677092,
               318759086822534,
               463245524370112,
               433586355598620,
               433576653396240,
               318765195038436,
               318742151485936,
               433551381437347,
               463256495559887,
               312246700545657,
               433584455402473,
               318786140288640,
               433550726609302,
               433617388523524,
               433589944604453,
               433605184274334,
               463252511009325,
               433581214139280,
               433495943877892,
               318763962951717,
               463251986858572,
               433552077260458,
               318766236335592,
               433613851755618,
               433627713110060,
               463246019798691,
               433590915572481,
               433551384557722,
               463247359326030,
               428109375851663,
               433590031784655,
               463247455596747,
               433616238546147,
               318763970368324,
               318778021443262,
               433554447428429,
               433583995452071,
               433590371650521,
               433621960801177,
               463247359372487,
               433587532362640,
               463242182507777,
               318697898317709,
               433589372009547,
               319120630807323,
               319120402222157,
               318757136018173,
               318774736573774,
               318761203836547,
               433611756790979,
               318784002521889,
               433577410522858,
               318755871993915,
               433592338055330,
               318785283501643,
               318785639450815,
               318775211263541,
               463235135503357,
               433556958970437,
               433600333431888,
               433596127756345,
               318785278864885,
               318767363808711,
               318754531328717,
               433554376137632,
               463215767568999,
               318784482233049,
               433588083694304,
               433621069459848,
               433556593467134,
               433625307594436,
               318789681841331,
               433556644729504,
               463237874553635,
               433617307852529,
               463275110281735,
               433589731258751,
               463232992418946,
               433557935706798,
               433599774656152,
               319114600733121,
               318788514087151,
               463221039354191,
               433617304797922,
               433584859010729,
               433630000307192,
               463231321439689,
               433625671715233,
               433556975376335,
               463219061244133,
               433624784128253,
               318778330945236,
               433556402426761,
               433555670170365,
               433594346332638,
               312254876848696,
               433625431688930,
               433613981156173,
               433555729257400,
               433627726121644,
               433621682709401,
               318774267375581,
               318777604128438,
               433550468521477,
               318781212070131,
               433480236902823,
               433619349943969,
               433557995523185,
               319121984871000,
               318784947674674,
               433611230799107,
               433630864362713,
               433557538660434,
               433621016760415,
               433612637970276,
               433557095918659,
               463208637546242,
               433615757131905,
               433557214173460,
               433611304854117,
               433618034663986,
               433557290637392,
               433609906337975,
               433524617641720,
               433555473098619,
               433618052245625,
               433597587569127,
               433555478851625,
               312255226404961,
               463231000551153,
               433619109495771,
               463242545382060,
               433613553948710,
               433555490115654,
               318747972704055,
               433555505649914,
               433627008045627,
               433555669546615,
               463284408131729,
               433554506509128,
               319122823980022,
               463221207943489,
               433554807300106,
               433555679996355,
               433556223912729,
               433589322952176,
               433555460482528,
               433555463556340,
               433554210703126,
               433554263967426,
               433552775076427,
               463219237665317,
               433558969432811,
               433563944592780,
               433552470999522,
               433565027370628,
               433550435115491,
               433553212151422,
               463285225252917,
               312246672811453,
               433552110684966,
               318742861911091,
               433552391218541,
               433550851488430,
               428106996353777,
               433550287102958,
               433552774189135,
               433553686103575,
               433553158804180,
               433553345565264,
               433553374464810,
               433551965933329,
               433552201349119,
               433546469547803,
               433551742599146,
               433547507630455,
               433550767368324,
               433549277115620,
               318741391486528,
               312246773459504,
               433548155275049,
               433548140811360,
               463279994513307,
               433598344641097,
               433548449589025,
               312247007095307,
               433548135524357,
               433548136620289,
               433596691974306,
               433598331545830,
               433593601504195,
               463220647643687,
               463277150916526,
               463288015992021,
               463285568415718,
               463277410520560,
               463275758907673,
               463275159238455,
               433619898744710,
               318781358300287,
               319123653682732,
               318741578552501,
               433547990251819,
               433547405505271,
               463266273916213,
               433572702038563,
               433599560604261,
               463266273911559,
               463266272430451,
               463264663135213,
               433548557176982,
               463227254335121,
               433620708781427,
               463222569316263,
               433548211411783,
               433553693646897,
               433614946196406,
               433549101784188,
               318742385958211,
               463265546435514,
               463218491657113,
               433554424340661,
               318766667444276,
               463281309627192,
               433612559585254,
               428110584342333,
               433544269036440,
               433626797901098,
               312253881019891,
               319113930494582,
               312253684663310,
               463211056752618,
               428110031460866,
               318779477579878,
               433585889555803,
               463266884475225,
               433550085759347,
               318779288111557,
               318779991511087,
               318743371394142,
               318779989494400,
               433556822869324,
               428109609174087,
               463291655795284,
               318780391328760,
               428106579918909,
               433614615878340,
               463215730900488,
               318782239497819,
               312255802820688,
               463257967172009,
               318779491818064,
               428106332276822,
               433613688085325,
               463246251747762,
               463288816268864,
               318741227756047,
               428109741258976,
               433612221380768,
               433588028589622,
               433599876122394,
               433532009765016,
               433587887579235,
               433583167276143,
               318749222764817,
               433573681121576,
               433608196211352,
               428106302983569,
               318740542945058,
               318762118220110,
               428108493694662,
               318760990112407,
               433549983458625,
               428108638124641,
               318759097101025,
               318770174010047,
               318778258632214,
               463271002549902,
               433585639472599,
               318776886701422,
               318758621157329,
               318781752383325,
               318757554137999,
               433622848564425,
               318740428502468,
               318751178835053,
               433620729907503,
               318740813748159,
               433605604578536,
               428107872909336,
               463218613261675,
               433591275034917,
               463287908310021,
               318779245081847,
               433608351867306,
               318744035417067,
               433618444089611,
               463260320091393,
               318742797906239,
               463250921991267,
               463260317775095,
               433609737148787,
               319118124922792,
               318756511982153,
               433611918105808,
               319119324126989,
               318742507230002,
               318777065582316,
               318740628789722,
               318777074390745,
               319115289961974,
               319114235358645,
               433611529191777,
               463218491430299,
               318777484543479,
               433544005558290,
               433583590723781,
               318779950439241,
               428108481464058,
               433581411591278,
               433610197791648,
               433609806657016,
               318778010514679,
               318741746602158,
               463276610373872,
               318768750802954,
               312253169229760,
               312253169225651,
               463238819182392,
               433610965094889,
               463291206609690,
               312253466593916,
               312247401585959,
               433614056159738,
               319124895710476,
               433625455830454,
               318778068319439,
               433596701003528,
               463224305060025,
               463294772512012,
               433592806162039,
               433611741902900,
               433592803084699,
               428106298758298,
               428105866127602,
               433597934151456,
               433612510346976,
               433549587495131,
               318787074299831,
               433549586028237,
               433614976770261,
               312247595660242,
               433549592842598,
               318780842377931,
               433549568021550,
               318789766509607,
               433616697587613,
               463274875612702,
               433549561282071,
               433609838275395,
               463255851953624,
               318756472952899,
               433559083278974,
               433608979014909,
               433607796291404,
               318781781719845,
               318782781980082,
               433612731720654,
               433613890885412,
               463292933055459,
               463285527318860,
               433623802791980,
               433606195619387,
               433575311148494,
               318783043083759,
               433543763784706,
               318781621394164,
               318788924043437,
               463275836249988,
               433609821226929,
               463285659485552,
               433625709169869,
               433610183073846,
               318779263236132,
               463278382470004,
               433611328557843,
               433616187050973,
               433614922816319,
               433545426945531,
               318783040669954,
               433625709213704,
               463285754711962,
               312250784915091,
               463210898931565,
               463286968012752,
               463268529220663,
               463275894225671,
               463275721870882,
               463238701472304,
               433552148853832,
               463285955133002,
               433549736411645,
               318763835921236,
               318741868783698,
               433619784164055,
               463240726137083,
               433549290174131,
               433610359822493,
               433573232969828,
               433549223886812,
               433619223760521,
               463274999526585,
               433549115704906,
               433549117126442,
               318741622103882,
               428110376399037,
               318784166484692,
               318741620263857,
               463210588238220,
               463278351001408,
               318778774472988,
               463209332528813,
               319122168480782,
               463285224690667,
               318739060277271,
               428108145442211,
               318739063142964,
               318776980458222,
               433617119204635,
               318739065116961,
               433600762896451,
               318739046670167,
               463275833128719,
               433544459155707,
               318780114019320,
               433544468217916,
               433608102307382,
               433611234203715,
               318772981621544,
               433544461461723,
               463277099939028,
               433544465899346,
               463275084628726,
               433604604430399,
               463210119032030,
               433589522716344,
               433621595327071,
               318740153314969,
               433616066781514,
               433545791437333,
               319123735621178,
               433627592012205,
               463252357423494,
               433629391535112,
               463208625636645,
               433545290246718,
               318783873709329,
               433546041568163,
               433629025292869,
               318770889967320,
               319114113475771,
               433627627924050,
               463259921139484,
               318738802339744,
               433576299506049,
               318739080907396,
               433497124505837,
               463285692962602,
               433569786421736,
               318738702228085,
               433602924906789,
               433620015339512,
               433625590896971,
               463217583864409,
               463285589211361,
               433619094282286,
               433610034086131,
               433613684796717,
               433597162225552,
               433597162225645,
               463286665033977,
               433495741257733,
               318783234394815,
               433625801273917,
               318778228892421,
               433619655880411,
               433617532449044,
               433607242251731,
               433625481686133,
               463279632791750,
               463264764273676,
               318787169936220,
               318781118918284,
               433603055718446,
               433609886694045,
               433609620693799,
               433624852438529,
               433602890513277,
               463187485529414,
               463291819673760,
               319123262569952,
               433623237321217,
               463282353863534,
               463282278717691,
               463284253796988,
               433625807361870,
               463282774400051,
               433551934840342,
               319122791996661,
               463278392788736,
               318780573213749,
               463268110084283,
               433596411085941,
               318774454551397,
               433604854025659,
               318771804575145,
               319125233039582,
               433603968026632,
               428107390648808,
               318771790834737,
               433546912405554,
               433610876214293,
               318790261414975,
               433603955109344,
               433583698173503,
               433616028751811,
               433629313913520,
               318786728521715,
               433457608190487,
               433618891465420,
               463275729193404,
               433604983901531,
               318771894960536,
               433620979215915,
               433600291563467,
               318784575674764,
               463157685709170,
               433600878899464,
               433554566360707,
               433610597322212,
               433613348619137,
               433622524596360,
               318738079471345,
               318740212837967,
               463191764984090,
               318773276437997,
               318738139360357,
               318780212084688,
               318771170727962,
               463280298718224,
               318738133827428,
               433609834139712,
               463266317107521,
               318738065674311,
               463286435100599,
               433617406209234,
               318771907704660,
               318738808873927,
               433611516433015,
               433615245273536,
               318738709090588,
               433621718168601,
               433615853712537,
               318738181992452,
               433616630910450,
               318780442524436,
               463213467069801,
               318781930897260,
               318771710662455,
               318753556501237,
               318783783996496,
               463272744020162,
               463286806632846,
               433608073802044,
               433625493043729,
               463208042424180,
               463210168293227,
               433614890218447,
               318738074235152,
               318777689476003,
               318770169069867,
               318781937340644,
               318770016118908,
               433614915655985,
               318738142963059,
               433597678924994,
               433613726176996,
               433615582334266,
               318769829147140,
               318738445671904,
               433624042189764,
               433608159584030,
               463208328255975,
               433625087202475,
               318770432852535,
               433547647050090,
               318770432392356,
               433609877308605,
               433547686394415,
               318770407728747,
               433620052631696,
               433617083513514,
               318770442203285,
               433625252481443,
               463277076013923,
               319124718308576,
               463285996638550,
               318741313904668,
               433623252596832,
               312251786245062,
               433618610080555,
               433610302205461,
               433623789077130,
               312251489571169,
               463285183601447,
               318769472891140,
               433623769740005,
               318769425384119,
               318740093214111,
               463281862820995,
               433619399915872,
               433625247166808,
               318778703130284,
               433612575872999,
               463288379126433,
               318767767159786,
               318768754420514,
               433616025384632,
               318769557151511,
               463286533503731,
               318769535716693,
               319122879854631,
               433547270130751,
               463257037336637,
               319123382284179,
               463275543291647,
               463256881620035,
               433605294309609,
               433620006098791,
               433622580652801,
               319123296765064,
               463257316326882,
               433617485446134,
               318740035734356,
               319122805268669,
               318785587996676,
               318767819908439,
               318782449044153,
               318767833264399,
               318784677817588,
               433548591856110,
               433547682035651,
               318786741740622,
               463286207103189,
               463258341870681,
               463285941646870,
               463249060008559,
               318767810904466,
               433545291401380,
               318784774901732,
               463250452103150,
               318768347960414,
               433585831951159,
               463287704192136,
               318768370234062,
               318736992638128,
               318781500003731,
               433611593645445,
               433627751976130,
               463275959245097,
               463285988494969,
               463287767611090,
               463286058262907,
               319122880932202,
               463286885275052,
               463287834337319,
               433620440230529,
               318770439221279, 318765985052231, 318765981229336, 318765959920432, 318765991041965, 318765962780323,
               318765962780139, 318765992051080, 318765959920153, 318765978286107, 318765974608806, 318765969927496,
               318765964640502, 318765964640310, 318765985051525, 318765980259724, 318765974608703, 318765961666991,
               318765975536285, 318765971667993, 318765981225423, 318765980259623, 318765950897412, 318765969927208,
               318765969927301, 318765969927117, 318765969927028, 318765973596293, 318765992050756, 318765964640126,
               318765987052231, 318765990042759, 318765959919711, 318765980259239, 318765975535979, 318765977359482,
               318765962779785, 318765972470140, 318765980259059, 318765985051149, 318765976490223, 318765981224147,
               318765971667785, 318765973596102, 318765983113245, 318765971667684, 318765971667488, 318765976490043,
               318765990042274, 318765967607596, 318765955992693, 318765978285683, 318765964639780, 318765989023732,
               318765978285584, 318765969926895, 318765979185401, 318765983113154, 318765987052140, 318765975535771,
               318765975535874, 318765969926792, 318765959919511, 318765980258822, 318765983112945]
    text_array = [str(num) for num in numbers]
    print(batch_call_recall_api(text_array))
